---
title: 数据抓包 - wireshark
date: 2021-11-25
categories:
 - 工具&部署
tags:
 - wireshark
 - 常用工具



---

# wireshark 实用过滤表达式



## 1 关键字

- 等于： == 或者 eq
- 与：&& 或者 and
- 或：|| 或者 or
- 非： ！或者 not



## 2 针对ip过滤

- 来源地址 ip 过滤，`ip.src`

对源地址为192.168.0.1的包的过滤，即抓取源地址满足要求的包。

    表达式为：ip.src == 192.168.0.1

- 目的地址ip 过滤，`ip.dst`

对目的地址为192.168.0.1的包的过滤，即抓取目的地址满足要求的包。

    表达式为：ip.dst == 192.168.0.1

- 原地址或目的地址 `ip.addr`　

对源或者目的地址为192.168.0.1的包的过滤，即抓取满足源或者目的地址的ip地址是192.168.0.1的包。

    表达式为：
     ip.addr == 192.168.0.1,本表达式的等价表达式为
     ip.src == 192.168.0.1or ip.dst == 192.168.0.1



## 3 针对协议

1. 使用在过滤器中填写协议名称
2. 多个协议组合 使用 and or not 组合

## 4 端口过滤

协议名+port 格式

例如：tcp.port 、udp.port 等



## 5 针对长度和内容的过滤

(1) 针对长度的过虑（这里的长度指定的是数据段的长度）

   表达式为：udp.length < 30   http.content_length <=20

(2) 针对数据包内容的过滤

 表达式为：http.request.urimatches "vipscu"  （匹配http请求中含有vipscu字段的请求信息）
