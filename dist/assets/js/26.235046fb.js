(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{601:function(v,t){v.exports="data:image/png;base64,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"},602:function(v,t){v.exports="data:image/png;base64,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"},686:function(v,t,r){"use strict";r.r(t);var a=r(4),_=Object(a.a)({},(function(){var v=this,t=v.$createElement,a=v._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[a("ol",[a("li",[v._v("分库分表一定是为了"),a("strong",[v._v("支撑高并发、数据量大")]),v._v("两个问题的")]),v._v(" "),a("li",[v._v("分库分表要考虑使用何种id策略")]),v._v(" "),a("li",[v._v("分库分表要考虑如何做数据迁移，做好迁移方案")]),v._v(" "),a("li",[v._v("分库分表的之后，数据量继续增加，预留不够的时候如果进行扩容")]),v._v(" "),a("li",[v._v("评估分库分表后带来的问题，选择合理的方案来应对")])]),v._v(" "),a("h1",{attrs:{id:"谈一谈分库分表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#谈一谈分库分表"}},[v._v("#")]),v._v(" 谈一谈分库分表")]),v._v(" "),a("h2",{attrs:{id:"_1-为什么要分库分表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-为什么要分库分表"}},[v._v("#")]),v._v(" 1 为什么要分库分表")]),v._v(" "),a("p",[v._v("在谈分库分表之前，需要先明确两个概念，分库和分表，是两个不同的动作。当单库连接数过多或者单表数据量过大的时候，数据库的性能就会变差，影响业务响应速度，而分库和分表的根本目的就是解决数据库在性能上瓶颈。")]),v._v(" "),a("p",[v._v("在当今互联网行业，大量数据，很容易就会出现需要分库分表的场景。")]),v._v(" "),a("ul",[a("li",[a("strong",[v._v("分表")])])]),v._v(" "),a("p",[v._v("比如你单表都几千万数据了，你确定你能扛住么？绝对不行，"),a("strong",[v._v("单表数据量太大")]),v._v("，会极大影响你的 sql "),a("strong",[v._v("执行的性能")]),v._v("，到了后面你的 sql 可能就跑的很慢了。一般来说，单表到几百万的时候，性能就会相对差一些了，你就得分表了。")]),v._v(" "),a("p",[v._v("分表是啥意思？就是把一个表的数据放到多个表中，然后查询的时候你就查一个表。比如按照用户 id 来分表，将一个用户的数据就放在一个表中。然后操作的时候你对一个用户就操作那个表就好了。这样可以控制每个表的数据量在可控的范围内，比如每个表就固定在 200 万以内。")]),v._v(" "),a("ul",[a("li",[a("strong",[v._v("分库")])])]),v._v(" "),a("p",[v._v("分库是啥意思？就是你一个库一般我们经验而言，最多支撑到并发 2000，一定要扩容了，而且一个健康的单库并发值你最好保持在每秒 1000 左右，不要太大。那么你可以将一个库的数据拆分到多个库中，访问的时候就访问一个库好了。")]),v._v(" "),a("p",[v._v("这就是所谓的"),a("strong",[v._v("分库分表")]),v._v("。")]),v._v(" "),a("table",[a("thead",[a("tr",[a("th",[v._v("#")]),v._v(" "),a("th",[v._v("分库分表前")]),v._v(" "),a("th",[v._v("分库分表后")])])]),v._v(" "),a("tbody",[a("tr",[a("td",[v._v("并发支撑情况")]),v._v(" "),a("td",[v._v("MySQL 单机部署，扛不住高并发")]),v._v(" "),a("td",[v._v("MySQL 从单机到多机，能承受的并发增加了多倍")])]),v._v(" "),a("tr",[a("td",[v._v("磁盘使用情况")]),v._v(" "),a("td",[v._v("MySQL 单机磁盘容量几乎撑满")]),v._v(" "),a("td",[v._v("拆分为多个库，数据库服务器磁盘使用率大大降低")])]),v._v(" "),a("tr",[a("td",[v._v("SQL 执行性能")]),v._v(" "),a("td",[v._v("单表数据量太大，SQL 越跑越慢")]),v._v(" "),a("td",[v._v("单表数据量减少，SQL 执行效率明显提升")])])])]),v._v(" "),a("p",[v._v("分库分表一定是为了"),a("strong",[v._v("支撑高并发、数据量大")]),v._v("两个问题的")]),v._v(" "),a("h2",{attrs:{id:"_2-如何进行分库分表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-如何进行分库分表"}},[v._v("#")]),v._v(" 2 如何进行分库分表")]),v._v(" "),a("p",[v._v("分库分表一般的拆分原则有两种，一种是水平拆分、一种是垂直拆分，下面对两种拆分方式进行说明")]),v._v(" "),a("h3",{attrs:{id:"_2-1-水平切分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-水平切分"}},[v._v("#")]),v._v(" 2.1 水平切分")]),v._v(" "),a("p",[v._v("水平拆分，按照字面意思，水平切割，把数据分成多份。如果理解呢，想想数据表，有100行数据，从中间切开，各50行数据，切分后两份数据格式上是一致。这种及时水平切分")]),v._v(" "),a("p",[a("strong",[v._v("水平切分的特点")]),v._v("：数据库的数据结构不发生变化，数据分不同组，根据分表算法，落到不同的分表（库）中。")]),v._v(" "),a("p",[a("img",{attrs:{src:r(601),alt:""}})]),v._v(" "),a("p",[a("strong",[v._v("适用场景")]),v._v("：单表（库）数据比较多，切分后减少单次访问的搜索范围")]),v._v(" "),a("h3",{attrs:{id:"_2-2-垂直切分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-垂直切分"}},[v._v("#")]),v._v(" 2.2 垂直切分")]),v._v(" "),a("p",[v._v("垂直切割，按字面意思就是垂直方案切割，分成多份，多份之间通过某个信息关联，在需要时候可以联合切分的数据，还原完整数据。")]),v._v(" "),a("p",[a("img",{attrs:{src:r(602),alt:""}})]),v._v(" "),a("p",[v._v("如上实例，表中有很多数据列，对其记性拆分后，分为多个表。 实例中示例：用户表记录用户很多信息（很多列），这个时候按照用户id关联，会"),a("strong",[v._v("将较少的访问频率很高的字段放到一个表里去")]),v._v("，然后"),a("strong",[v._v("将较多的访问频率很低的字段放到另外一个表里去")]),v._v("。因为数据库是有缓存的，你访问频率高的行字段越少，就可以在缓存里缓存更多的行，性能就越好。这个一般在表层面做的较多一些。")]),v._v(" "),a("p",[a("strong",[v._v("垂直切分特点：")]),v._v(" 拆分高频低频，合理利用数据库缓存空间")]),v._v(" "),a("p",[a("strong",[v._v("适用场景：")]),v._v(" 表（库）数据结构比较复杂（列比较多），通过切割成不同的表（库）来提供效率")]),v._v(" "),a("h3",{attrs:{id:"_2-3-常用分库分表实践方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-常用分库分表实践方案"}},[v._v("#")]),v._v(" 2.3 常用分库分表实践方案")]),v._v(" "),a("p",[v._v("水平切分和垂直切分实现时候有很多方案（分片策略），一般有以下几种")]),v._v(" "),a("ol",[a("li",[a("strong",[v._v("按照 range 来分")]),v._v("：就是每个库一段连续的数据，这个一般是按比如"),a("strong",[v._v("时间范围")]),v._v("来的，但是这种一般较少用，因为很容易产生热点问题，大量的流量都打在最新的数据上了。")]),v._v(" "),a("li",[a("strong",[v._v("按照某个字段 hash/取模")]),v._v("  一下均匀分散，这个较为常用，例如 用户id(或者id的hashCode)取模")])]),v._v(" "),a("p",[v._v("在实际生产中，有很多中间件可以借用，帮助我们完成整个分库分表的实现，比较常见的包括：")]),v._v(" "),a("ul",[a("li",[v._v("Cobar")]),v._v(" "),a("li",[v._v("TDDL")]),v._v(" "),a("li",[v._v("Atlas")]),v._v(" "),a("li",[v._v("Sharding-jdbc")]),v._v(" "),a("li",[v._v("Mycat")])]),v._v(" "),a("p",[a("strong",[v._v("Cobar")])]),v._v(" "),a("p",[v._v("阿里 b2b 团队开发和开源的，属于 proxy 层方案，就是介于应用服务器和数据库服务器之间。应用程序通过 JDBC 驱动访问 Cobar 集群，Cobar 根据 SQL 和分库规则对 SQL 做分解，然后分发到 MySQL 集群不同的数据库实例上执行。早些年还可以用，但是最近几年都没更新了，基本没啥人用，差不多算是被抛弃的状态吧。而且不支持读写分离、存储过程、跨库 join 和分页等操作。")]),v._v(" "),a("p",[a("strong",[v._v("TDDL")])]),v._v(" "),a("p",[v._v("淘宝团队开发的，属于 client 层方案。支持基本的 crud 语法和读写分离，但不支持 join、多表查询等语法。目前使用的也不多，因为还依赖淘宝的 diamond 配置管理系统。")]),v._v(" "),a("p",[a("strong",[v._v("Atlas")])]),v._v(" "),a("p",[v._v("360 开源的，属于 proxy 层方案，以前是有一些公司在用的，但是确实有一个很大的问题就是社区最新的维护都在 5 年前了。所以，现在用的公司基本也很少了。")]),v._v(" "),a("p",[a("strong",[v._v("Sharding-jdbc")])]),v._v(" "),a("p",[v._v("当当开源的，属于 client 层方案，是"),a("a",{attrs:{href:"https://shardingsphere.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[a("code",[v._v("ShardingSphere")]),v._v(" "),a("OutboundLink")],1),v._v("的 client 层方案，"),a("a",{attrs:{href:"https://shardingsphere.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[a("code",[v._v("ShardingSphere")]),v._v(" "),a("OutboundLink")],1),v._v("还提供 proxy 层的方案 Sharding-Proxy。确实之前用的还比较多一些，因为 SQL 语法支持也比较多，没有太多限制，而且截至 2019.4，已经推出到了 "),a("code",[v._v("4.0.0-RC1")]),v._v(" 版本，支持分库分表、读写分离、分布式 id 生成、柔性事务（最大努力送达型事务、TCC 事务）。而且确实之前使用的公司会比较多一些（这个在官网有登记使用的公司，可以看到从 2017 年一直到现在，是有不少公司在用的），目前社区也还一直在开发和维护，还算是比较活跃，算是一个现在也"),a("strong",[v._v("可以选择的方案")]),v._v("。")]),v._v(" "),a("p",[a("strong",[v._v("Mycat")])]),v._v(" "),a("p",[v._v("基于 Cobar 改造的，属于 proxy 层方案，支持的功能非常完善，而且目前应该是非常火的而且不断流行的数据库中间件，社区很活跃，也有一些公司开始在用了。但是确实相比于 Sharding jdbc 来说，年轻一些，经历的锤炼少一些。")]),v._v(" "),a("h2",{attrs:{id:"_3-分库分表后的id问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-分库分表后的id问题"}},[v._v("#")]),v._v(" 3 分库分表后的id问题")]),v._v(" "),a("p",[v._v("关于分库分表后id的问题，可以采用分布式id实现方案来解决，具体方案参见 "),a("a",{attrs:{href:"http://www.jnote.net/04-architecture/ds/010-ds-id.html",target:"_blank",rel:"noopener noreferrer"}},[v._v("分布式：全局唯一ID实现方案"),a("OutboundLink")],1),v._v(" , 下面简单介绍下。")]),v._v(" "),a("h3",{attrs:{id:"_3-1-基于uuid生成id"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-基于uuid生成id"}},[v._v("#")]),v._v(" 3.1 基于UUID生成id")]),v._v(" "),a("p",[v._v("使用UUID生成id, 保证所有分片的id不重复。")]),v._v(" "),a("p",[a("strong",[v._v("优点")])]),v._v(" "),a("ul",[a("li",[v._v("生成方便，单机直接生成")])]),v._v(" "),a("p",[a("strong",[v._v("缺点")])]),v._v(" "),a("ul",[a("li",[v._v("不易存储，字段较长")]),v._v(" "),a("li",[v._v("对MySQL索引不友好")]),v._v(" "),a("li",[v._v("信息安全问题")])]),v._v(" "),a("h3",{attrs:{id:"_3-2-基于数据库自增方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-基于数据库自增方案"}},[v._v("#")]),v._v(" 3.2 基于数据库自增方案")]),v._v(" "),a("p",[v._v("利用数据库自增+固定步长 把id分散，具体方案和优劣请看 "),a("a",{attrs:{href:"http://www.jnote.net/04-architecture/ds/010-ds-id.html",target:"_blank",rel:"noopener noreferrer"}},[v._v("分布式：全局唯一ID实现方案"),a("OutboundLink")],1)]),v._v(" "),a("p",[v._v("此方式另外还会存在扩容问题，下一节会说到")]),v._v(" "),a("h3",{attrs:{id:"_3-3分布式全局id算法方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3分布式全局id算法方案"}},[v._v("#")]),v._v(" 3.3分布式全局id算法方案")]),v._v(" "),a("p",[v._v("此类算法分为两类 ：分布式中心生成唯一id再分配，类snowflake算法，具体方案和优劣请看 "),a("a",{attrs:{href:"http://www.jnote.net/04-architecture/ds/010-ds-id.html",target:"_blank",rel:"noopener noreferrer"}},[v._v("分布式：全局唯一ID实现方案"),a("OutboundLink")],1)]),v._v(" "),a("ul",[a("li",[v._v("分布式中心生成唯一id再分配：redis生成id、专门数据库序列中心")]),v._v(" "),a("li",[v._v("类snowflake算法：snowflake算法、百度UidGenerator、美团Leaf、腾讯Seqsvr 等")])]),v._v(" "),a("h2",{attrs:{id:"_4-分库分表后如何过渡与迁移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-分库分表后如何过渡与迁移"}},[v._v("#")]),v._v(" 4 分库分表后如何过渡与迁移")]),v._v(" "),a("p",[v._v("分库分表后，一个直接要面对的问题就是老系统如果过渡和迁移，如果是新的系统，设计的时候直接分库分表了没有问题，老系统没有分库分表的话，要如果进行切换呢？")]),v._v(" "),a("h3",{attrs:{id:"_4-1-停机迁移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-停机迁移"}},[v._v("#")]),v._v(" 4.1 停机迁移")]),v._v(" "),a("p",[v._v("最简单便捷的方案就是停机迁移，期间服务不可用，如果能够容忍，则是一个不错的选择。例如在晚间挂上公告，系统升级中。然后编写一个数据导入工具，直接按照规则，把老数据导入到新的数据库和表中。部署新的服务，跑完收工。")]),v._v(" "),a("p",[v._v("这种方式优点就是简单，缺点及时需要停服务，如果有些业务服务不能接收停服，则此方案不行了。")]),v._v(" "),a("h3",{attrs:{id:"_4-2-双写迁移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-双写迁移"}},[v._v("#")]),v._v(" 4.2 双写迁移")]),v._v(" "),a("p",[v._v("双写方案，顾明意思，就是新老数据库（表同时写入数据），业务修改数据写入层逻辑，对数据执行双写，同时按照新规则和老规则写入数据。 这种方案实现起来比较的复杂，需要记录下修改时间，增量数据在新库（表）中同步写入了，但是历史数据的更新，则需要使用同步工具做一些校准，同时比对新库（表）确认为历史数据的修改，并把最新的数据导入到新库。实现起来考虑的点比较多。")]),v._v(" "),a("p",[a("strong",[v._v("系统部署")]),v._v("之后，新库数据差太远，用之前说的导数工具，跑起来读老库数据写新库，写的时候要根据 gmt_modified 这类字段判断这条数据最后修改的时间，除非是读出来的数据在新库里没有，或者是比新库的数据新才会写。简单来说，就是不允许用老数据覆盖新数据。")]),v._v(" "),a("p",[v._v("导完一轮之后，有可能数据还是存在不一致，那么就程序自动做一轮校验，比对新老库每个表的每条数据，接着如果有不一样的，就针对那些不一样的，从老库读数据再次写。反复循环，直到两个库每个表的数据都完全一致为止。")]),v._v(" "),a("p",[v._v("此方案优点不用停服务，缺点就是对于历史数据修改的校准和导入问题比较复杂，需要做逻辑判断处理。")]),v._v(" "),a("h2",{attrs:{id:"_5-分库分表之后如何进行扩容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-分库分表之后如何进行扩容"}},[v._v("#")]),v._v(" 5 分库分表之后如何进行扩容")]),v._v(" "),a("p",[v._v("一般在设计分库分表大小的时候精良预估个3-5年的量，一般这个时间过后，系统也可能面临重构了。但是预估不一定就够，依然存在扩容的可能，所以分库分表后的扩容还是需要被考虑的。")]),v._v(" "),a("p",[v._v("分库分表之后的扩容问题会因采取的全局id方案、分片策略的不同而不同，下面针对不同情况分析一下")]),v._v(" "),a("h3",{attrs:{id:"_5-1-id策略对扩容影响"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-id策略对扩容影响"}},[v._v("#")]),v._v(" 5.1 id策略对扩容影响")]),v._v(" "),a("p",[v._v("使用全局id生成法生成的全局id基本对扩容不会造成影响，扩容之后依然可以使用之前的策略生成id并使用。但是使用 "),a("strong",[v._v("数据库自增id+固定步长")]),v._v(" 方式生成id的，会在扩容时候有影响")]),v._v(" "),a("p",[v._v("假设原来分为3个表，步长为3 则id表现如下")]),v._v(" "),a("p",[v._v("table_0: 1, 4, 7, 10....")]),v._v(" "),a("p",[v._v("table_1: 2, 5, 8, 11...")]),v._v(" "),a("p",[v._v("table_2: 3, 6, 9, 12...")]),v._v(" "),a("p",[v._v("当此时需要扩张表，例如扩张到5张的时候，数据库id就需要处理下")]),v._v(" "),a("p",[v._v("此时可以有两种方式")]),v._v(" "),a("ol",[a("li",[v._v("数据迁移，迁移完成后从一个新起点开始自增并设置步长为5 (id作为shardingKey)")]),v._v(" "),a("li",[v._v("不迁移数据，从一个新起点开始自增并设置步长为5(id不是shardingKey)")])]),v._v(" "),a("h3",{attrs:{id:"_5-2-分片策略对扩容的影响"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-分片策略对扩容的影响"}},[v._v("#")]),v._v(" 5.2 分片策略对扩容的影响")]),v._v(" "),a("p",[v._v("由于分片策略不同，扩容之后需要保证已有数据分到正确的分片（库/表）里面, 则需要考虑分片策略对扩容影响")]),v._v(" "),a("ol",[a("li",[v._v("range分片，扩容基本不会有影响，例如按照时间（一个月或者一年一个分片）、用户id范围（0-100000,100000-200000）等")]),v._v(" "),a("li",[v._v("hash/mod 这种方式的影响比较大，例如原来分10片，用户id mod 10,  后来扩容到20 则mod 20 已有数据就需要处理下")])]),v._v(" "),a("p",[v._v("无论是 id策略还是分片策略的影响，在扩容的时候都需要考虑，那么实际中该如何解决扩容的问题呢？下面来简单说明下。")]),v._v(" "),a("h3",{attrs:{id:"_5-3-动态扩容方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-动态扩容方案"}},[v._v("#")]),v._v(" 5.3 动态扩容方案")]),v._v(" "),a("p",[v._v("参考："),a("a",{attrs:{href:"https://www.cnblogs.com/barrywxx/p/11532122.html",target:"_blank",rel:"noopener noreferrer"}},[v._v("分库分表平滑扩容"),a("OutboundLink")],1)]),v._v(" "),a("ul",[a("li",[a("p",[v._v("方案1：数据迁移")]),v._v(" "),a("p",[v._v("这种方案很好理解，基本思想就是按照新的规则，分库分表后，原有数据需要做迁移，而迁移方案就是利用前文提到的两种，如果业务可以接受停服，直接停服迁移，最为简单快捷。如果服务不允许停服，可以使用双写方案，把数据迁移到新的分表。")])]),v._v(" "),a("li",[a("p",[v._v("方案2：升级从库")]),v._v(" "),a("p",[v._v("这个方案我这里直接借用 "),a("a",{attrs:{href:"https://www.cnblogs.com/barrywxx/p/11532122.html",target:"_blank",rel:"noopener noreferrer"}},[v._v("分库分表平滑扩容"),a("OutboundLink")],1),v._v(" 文中的描述， 说明如下：")]),v._v(" "),a("p",[v._v("线上数据库，我们为了保持其高可用，一般都会每台主库配一台从库，读写在主库，然后主从同步到从库。如下，A，B是主库，A0和B0是从库。")]),v._v(" "),a("p",[a("img",{attrs:{src:"http://p3.pstatp.com/large/46f800047cfb4105ad6f",alt:"水平分库如何做到平滑扩展"}})]),v._v(" "),a("p",[v._v("此时，当需要扩容的时候，我们把A0和B0升级为新的主库节点，如此由2个分库变为4个分库。同时在上层的分片配置，做好映射，规则如下:")]),v._v(" "),a("blockquote",[a("p",[v._v("uid%4=0和uid%4=2的分别指向A和A0，也就是之前指向uid%2=0的数据，分裂为uid%4=0和uid%4=2")]),v._v(" "),a("p",[v._v("uid%4=1和uid%4=3的指向B和B0，也就是之前指向uid%2=1的数据，分裂为uid%4=1和uid%4=3")])]),v._v(" "),a("p",[v._v("因为A和A0库的数据相同，B和B0数据相同，所以此时无需做数据迁移即可。只需要变更一下分片配置即可，通过配置中心更新，无需重启。")]),v._v(" "),a("p",[a("img",{attrs:{src:"http://p3.pstatp.com/large/46fa00014eb080278ec5",alt:"水平分库如何做到平滑扩展"}})]),v._v(" "),a("p",[v._v("由于之前uid%2的数据分配在2个库里面，此时分散到4个库中，由于老数据还存在（uid%4=0,还有一半uid%4=2的数据），所以需要对冗余数据做一次清理。")]),v._v(" "),a("p",[v._v("而这个清理，不会影响线上数据的一致性，可是随时随地进行。")]),v._v(" "),a("p",[v._v("处理完成以后，为保证高可用，以及下一步扩容需求。可以为现有的主库再次分配一个从库。")]),v._v(" "),a("p",[a("img",{attrs:{src:"http://p1.pstatp.com/large/46fd0000f35d1a082f74",alt:"水平分库如何做到平滑扩展"}})]),v._v(" "),a("p",[v._v("总结一下此方案步骤如下：")]),v._v(" "),a("blockquote",[a("ol",[a("li",[v._v("修改分片配置，做好新库和老库的映射。")]),v._v(" "),a("li",[v._v("同步配置，从库升级为主库")]),v._v(" "),a("li",[v._v("解除主从关系")]),v._v(" "),a("li",[v._v("冗余数据清理")]),v._v(" "),a("li",[v._v("为新的数据节点搭建新的从库")])])])])]),v._v(" "),a("h2",{attrs:{id:"_6-分库分表后带来的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-分库分表后带来的问题"}},[v._v("#")]),v._v(" 6 分库分表后带来的问题")]),v._v(" "),a("p",[v._v("分库分表虽然能够帮我提升数据库层级的性能，帮助我们抗住更多连接和并发，但是选择使用了分库分表后，会带来很多必需要面对的问题。")]),v._v(" "),a("p",[v._v("最常见的就是"),a("strong",[v._v("聚合查询类问题")]),v._v("和"),a("strong",[v._v("分布式事务问题")]),v._v("。因此，我们不能为了分库分表而分库分表，任何事物产生都是有原因的，在决定是否使用分库分表的时候，要综合考虑是否真的业务量达到较高水平，数据库是否真的是瓶颈，业务上是否可能优化解决。")]),v._v(" "),a("h3",{attrs:{id:"_6-1-聚合查询问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-聚合查询问题"}},[v._v("#")]),v._v(" 6.1 聚合查询问题")]),v._v(" "),a("p",[v._v("关于聚合类问题，主要是 join查询、按条件聚合查询、orderby(排序、分页) 等涉及到查询的数据来源于多个分片分问题（分片查询根据shardingKey来路由）。")]),v._v(" "),a("p",[v._v("一个典型的示例： 如果我们的订单是按照用户id 分表的，在C端查询时候主要以用户id为维度，直接定位到单表，没有问题，但是当在B端商户需要查询订单列表的时候，用户数据分散在不同表（shardingKey为用户id，不是订单号），此时数据就需要聚合，同时列表还存在排序分页的问题，更加难以处理。")]),v._v(" "),a("p",[v._v("分析问题原因：主要原因在于查询的数据是分散的，根据非shardingKey进行了查询导致。")]),v._v(" "),a("p",[v._v("面对这类问题，一般又该如何去解决呢？可以从以下三个方向考虑")]),v._v(" "),a("ol",[a("li",[v._v("程序内存处理")]),v._v(" "),a("li",[v._v("数据双写")]),v._v(" "),a("li",[v._v("数据仓库或者ES查询")])]),v._v(" "),a("p",[a("strong",[v._v("1 程序内存处理")])]),v._v(" "),a("p",[v._v("这种方式的思想就是把原来的一条查询分开成多个查询，把查询出来的结果在程序中进行聚合处理，最终返回。")]),v._v(" "),a("p",[v._v("例如：")]),v._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[v._v("1. join查询分为一个条件查询 + 一个或多个in查询。\n2. 分页查询，每个分片查询需要的分页数，在聚合。如查询 top10 需求，则每个分片查询top10 在聚合取整体top10\n")])])]),a("p",[v._v("这类查询有个最大的问题就是程序组合时候复杂度高，而且类似分页和排序这种，每页查询数量更多，内存消耗大，查询速度也慢，例如每页10条，查询低20页的时候，每个分片要查询出前200条数据，假设分片数为10 则总计查询2000条在内存中处理，如果分片数更大(一般32+ 分片) ，结果可想而知。")]),v._v(" "),a("p",[a("strong",[v._v("2 数据双写")])]),v._v(" "),a("p",[v._v("这种方式的思想比较好理解，既然产生问题的根本原因是非sharingKey查询导致，那么是否可以通过数据的双写或者多写完成呢")]),v._v(" "),a("p",[v._v("例如：上面的典型示例中，订单数据双写 一份按照用户id分片，一份按照商户id分片，这样在C端用户查询的时候，查询的是用户id分片的数据，而B端商户查询的时候，查询商户分片的数据。")]),v._v(" "),a("p",[v._v("此种方案基本上可以解决问题，但是也存在一些隐患")]),v._v(" "),a("ol",[a("li",[v._v("数据双写就存在要求数据一致性问题，两份数据的一致性需要做好保证（做好事务管理），代码逻辑上要做响应处理改造。")]),v._v(" "),a("li",[v._v("随着分片key的增加，数据可能不止一份，例如上述订单场景，如果加入地域 时间 查询之后等等")])]),v._v(" "),a("p",[v._v("总体来说，合理分定义分片的key 基本能够使用这套方案满足大部分业务场景。实现上也不是很复杂。可以根据具体的业务场景决定是否使用。")]),v._v(" "),a("p",[a("strong",[v._v("3 数据仓库或者ES查询")])]),v._v(" "),a("p",[v._v("这种方案是数据落库之后，不管你通过binlog还是MQ消息的都形式，把数据同步到数仓或者ES，他们支持的数量级对于这种查询条件来说就很简单了。同样这种方式肯定是稍微有延迟的，但是这种可控范围的延迟是可以接受的。")]),v._v(" "),a("p",[v._v("针对管理后台的查询，比如运营、业务、产品需要看数据，他们天然需要复杂的查询条件，同样走ES或者数仓都可以做得到")]),v._v(" "),a("p",[v._v("这种方案的不足：可能存在延迟")]),v._v(" "),a("p",[v._v("以上三种方案，都可以解决一些问题，也有自身的一些缺点，实际生产中，需要评估自己的业务，根据场景选择合适的方案，具体问题具体分析。")]),v._v(" "),a("h3",{attrs:{id:"_6-2-分布式事务问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-分布式事务问题"}},[v._v("#")]),v._v(" 6.2 分布式事务问题")]),v._v(" "),a("p",[v._v("分库分表的另外的一个典型问题就是分布式事务问题。")]),v._v(" "),a("p",[v._v("以前在同一个库的事务操作，直接单库事务解决，如今分库之后，事务可能是跨库甚至是跨数据库服务实例的，必然会导致之前的单库事务处理方案不适用，需要引入分布式事务方案来解决，系统复杂也对应的增加。")]),v._v(" "),a("p",[v._v("目前处理分布式事务的方案以下一些：")]),v._v(" "),a("ol",[a("li",[v._v("2PC (2 phase commit) XA协议")]),v._v(" "),a("li",[v._v("TCC (try-confirm-cancel)")]),v._v(" "),a("li",[v._v("本地消息表")]),v._v(" "),a("li",[v._v("MQ事务 （RocketMQ实现）")]),v._v(" "),a("li",[v._v("Saga事务")])]),v._v(" "),a("p",[v._v("具体参见小米技术团队的博客的介绍："),a("a",{attrs:{href:"https://xiaomi-info.github.io/2020/01/02/distributed-transaction/",target:"_blank",rel:"noopener noreferrer"}},[v._v("分布式事务，这一篇就够了"),a("OutboundLink")],1)]),v._v(" "),a("h2",{attrs:{id:"_7-总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-总结"}},[v._v("#")]),v._v(" 7 总结")]),v._v(" "),a("ol",[a("li",[v._v("分库分表一定是为了"),a("strong",[v._v("支撑高并发、数据量大")]),v._v("两个问题的")]),v._v(" "),a("li",[v._v("分库分表要考虑使用何种id策略")]),v._v(" "),a("li",[v._v("分库分表要考虑如何做数据迁移，做好迁移方案")]),v._v(" "),a("li",[v._v("分库分表的之后，数据量继续增加，预留不够的时候如果进行扩容")]),v._v(" "),a("li",[v._v("评估分库分表后带来的问题，选择合理的方案来应对")])]),v._v(" "),a("hr"),v._v(" "),a("p",[v._v("参考链接：")]),v._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://doocs.gitee.io/advanced-java/#/./docs/high-concurrency/database-shard",target:"_blank",rel:"noopener noreferrer"}},[v._v("为什么要分库分表"),a("OutboundLink")],1)])]),v._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://doocs.gitee.io/advanced-java/#/./docs/high-concurrency/database-shard-method",target:"_blank",rel:"noopener noreferrer"}},[v._v("分库分表如何平滑过渡"),a("OutboundLink")],1)])]),v._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://doocs.gitee.io/advanced-java/#/./docs/high-concurrency/database-shard-dynamic-expand",target:"_blank",rel:"noopener noreferrer"}},[v._v("设计一个动态扩容缩容的分库分表方案"),a("OutboundLink")],1)])]),v._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://segmentfault.com/a/1190000037776663",target:"_blank",rel:"noopener noreferrer"}},[v._v("百亿级数据分表后怎么分页查询？"),a("OutboundLink")],1)])]),v._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/barrywxx/p/11532122.html",target:"_blank",rel:"noopener noreferrer"}},[v._v("分库分表平滑扩容"),a("OutboundLink")],1)])])])])}),[],!1,null,null,null);t.default=_.exports}}]);